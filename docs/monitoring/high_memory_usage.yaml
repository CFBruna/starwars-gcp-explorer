displayName: "Star Wars API - High Memory Usage"
documentation:
  content: "Alert when P99 Memory usage exceeds 90% for 5 minutes"
  mimeType: "text/markdown"
conditions:
- displayName: "P99 Memory > 90%"
  conditionThreshold:
    filter: 'resource.type="cloud_run_revision" AND resource.labels.service_name="starwars-api" AND metric.type="run.googleapis.com/container/memory/utilizations"'
    aggregations:
    - alignmentPeriod: 60s
      perSeriesAligner: ALIGN_PERCENTILE_99
      crossSeriesReducer: REDUCE_MAX
    comparison: COMPARISON_GT
    thresholdValue: 0.9
    duration: 300s
    trigger:
      count: 1
notificationChannels:
- projects/YOUR_PROJECT_ID/notificationChannels/YOUR_CHANNEL_ID
combiner: OR
enabled: true
